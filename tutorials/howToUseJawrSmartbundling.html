<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2017-04-10 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170410" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Jawr - How to use Smart bundling feature in Jawr</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.1.min.js"></script>

              
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/j-a-w-r/jawr-main-repo">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2></h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2017-04-10
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 3.9
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">About</li>
                              
      <li>
  
                          <a href="../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                
      <li>
  
                          <a href="../introduction.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="../features.html" title="Features">
          <i class="none"></i>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../changes.html" title="Change history">
          <i class="none"></i>
        Change history</a>
            </li>
                
      <li>
  
                          <a href="../team.html" title="The team">
          <i class="none"></i>
        The team</a>
            </li>
                              <li class="nav-header">Documentation</li>
                              
      <li>
  
                          <a href="../docs/servlet.html" title="The Jawr servlet">
          <i class="none"></i>
        The Jawr servlet</a>
            </li>
                
      <li>
  
                          <a href="../docs/descriptor_syntax.html" title="Descriptor syntax">
          <i class="none"></i>
        Descriptor syntax</a>
            </li>
                
      <li>
  
                          <a href="../docs/custom_bundles.html" title="Bundle definition">
          <i class="none"></i>
        Bundle definition</a>
            </li>
                
      <li>
  
                          <a href="../docs/source_ordering.html" title="Source order in bundles">
          <i class="none"></i>
        Source order in bundles</a>
            </li>
                
      <li>
  
                          <a href="../docs/cacheManager.html" title="Cache manager">
          <i class="none"></i>
        Cache manager</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_preprocessors.html" title="Global preprocessors">
          <i class="none"></i>
        Global preprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/global_postprocessors.html" title="Global postprocessors">
          <i class="none"></i>
        Global postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/postprocessors.html" title="Postprocessors">
          <i class="none"></i>
        Postprocessors</a>
            </li>
                
      <li>
  
                          <a href="../docs/generators.html" title="Generators">
          <i class="none"></i>
        Generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/advanced_generators.html" title="Advanced generators">
          <i class="none"></i>
        Advanced generators</a>
            </li>
                
      <li>
  
                          <a href="../docs/license_files.html" title="Licenses in resources">
          <i class="none"></i>
        Licenses in resources</a>
            </li>
                
      <li>
  
                          <a href="../docs/taglibs.html" title="JSP Tag library">
          <i class="none"></i>
        JSP Tag library</a>
            </li>
                
      <li>
  
                          <a href="../docs/plain_html.html" title="Use in HTML pages">
          <i class="none"></i>
        Use in HTML pages</a>
            </li>
                
      <li>
  
                          <a href="../docs/modes.html" title="Debug and production modes">
          <i class="none"></i>
        Debug and production modes</a>
            </li>
                
      <li>
  
                          <a href="../docs/messages_gen.html" title="i18n message generator">
          <i class="none"></i>
        i18n message generator</a>
            </li>
                
      <li>
  
                          <a href="../docs/variant_bundle.html" title="Variant bundles">
          <i class="none"></i>
        Variant bundles</a>
            </li>
                
      <li>
  
                          <a href="../docs/illegalBundleRequestHander.html" title="Jawr strict mode - Illegal bundle request handler">
          <i class="none"></i>
        Jawr strict mode - Illegal bundle request handler</a>
            </li>
                
      <li>
  
                          <a href="../docs/jmx_support.html" title="JMX Support">
          <i class="none"></i>
        JMX Support</a>
            </li>
                
      <li>
  
                          <a href="../docs/bundle_preprocessing.html" title="Bundle preprocessing">
          <i class="none"></i>
        Bundle preprocessing</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_maven_plugin.html" title="Jawr Maven plugin">
          <i class="none"></i>
        Jawr Maven plugin</a>
            </li>
                
      <li>
  
                          <a href="../docs/jawr_ant_task.html" title="Jawr Ant task">
          <i class="none"></i>
        Jawr Ant task</a>
            </li>
                
      <li>
  
                          <a href="../migrationGuide.html" title="Migration Guide">
          <i class="none"></i>
        Migration Guide</a>
            </li>
                
      <li>
  
                          <a href="../migrationGitRepo.html" title="Github repository Migration Guide">
          <i class="none"></i>
        Github repository Migration Guide</a>
            </li>
                              <li class="nav-header">Integration</li>
                              
      <li>
  
                          <a href="../integration/augmenter.html" title="Add Jawr to your framework">
          <i class="none"></i>
        Add Jawr to your framework</a>
            </li>
                
      <li>
  
                          <a href="../integration/spring.html" title="Spring MVC">
          <i class="none"></i>
        Spring MVC</a>
            </li>
                
      <li>
  
                          <a href="../integration/facelets.html" title="Facelets Tag library">
          <i class="none"></i>
        Facelets Tag library</a>
            </li>
                
      <li>
  
                          <a href="../integration/wicket.html" title="Wicket">
          <i class="none"></i>
        Wicket</a>
            </li>
                
      <li>
  
                          <a href="../integration/grails.html" title="Grails plugin">
          <i class="none"></i>
        Grails plugin</a>
            </li>
                
      <li>
  
                          <a href="../integration/dwr.html" title="DWR">
          <i class="none"></i>
        DWR</a>
            </li>
                
      <li>
  
                          <a href="../integration/validator.html" title="Commons Validator - Struts">
          <i class="none"></i>
        Commons Validator - Struts</a>
            </li>
                              <li class="nav-header">Tutorials</li>
                              
      <li>
  
                          <a href="../tutorials/quickstart.html" title="Quick start">
          <i class="none"></i>
        Quick start</a>
            </li>
                
      <li class="active">
  
            <a href="#"><i class="none"></i>How to use Jawr smart bundling feature</a>
          </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToServeImage.html" title="How to use Jawr to serve image resources">
          <i class="none"></i>
        How to use Jawr to serve image resources</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrCssSkin.html" title="How to use Jawr to generate CSS skin">
          <i class="none"></i>
        How to use Jawr to generate CSS skin</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/jawrSpriteImage.html" title="How to generate Image sprites with Jawr">
          <i class="none"></i>
        How to generate Image sprites with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseJawrToGenerateBase64Image.html" title="How to generate base64 images in CSS with Jawr">
          <i class="none"></i>
        How to generate base64 images in CSS with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToUseGoogleClosureCompiler.html" title="How to use Google Closure Compiler with Jawr">
          <i class="none"></i>
        How to use Google Closure Compiler with Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToSetJsEngine.html" title="How to set Javascript engine in Jawr">
          <i class="none"></i>
        How to set Javascript engine in Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/howToEnablePerformanceLogging.html" title="How to set performance logging in Jawr">
          <i class="none"></i>
        How to set performance logging in Jawr</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/faq_howto.html" title="FAQ-Howto">
          <i class="none"></i>
        FAQ-Howto</a>
            </li>
                
      <li>
  
                          <a href="../tutorials/libraries.html" title="Using popular libraries">
          <i class="none"></i>
        Using popular libraries</a>
            </li>
                
      <li>
  
                          <a href="../docs/sampleApplications.html" title="Sample applications">
          <i class="none"></i>
        Sample applications</a>
            </li>
                              <li class="nav-header">API and sources</li>
                              
      <li>
  
                          <a href="../nonav/apidocs/index.html" title="JavaDocs">
          <i class="none"></i>
        JavaDocs</a>
            </li>
                
      <li>
  
                          <a href="../nonav/xref/index.html" title="Source XREF">
          <i class="none"></i>
        Source XREF</a>
            </li>
                              <li class="nav-header">Github repositories</li>
                              
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-main-repo" class="externalLink" title="Jawr main repository">
          <i class="none"></i>
        Jawr main repository</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-core" class="externalLink" title="Jawr core repository">
          <i class="none"></i>
        Jawr core repository</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-spring" class="externalLink" title="Jawr spring repository">
          <i class="none"></i>
        Jawr spring repository</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-wicket" class="externalLink" title="Jawr wicket repository">
          <i class="none"></i>
        Jawr wicket repository</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-grails" class="externalLink" title="Jawr grails repository">
          <i class="none"></i>
        Jawr grails repository</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-dwr2.x" class="externalLink" title="Jawr dwr2.x repository">
          <i class="none"></i>
        Jawr dwr2.x repository</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-dwr3.x" class="externalLink" title="Jawr dwr3.x repository">
          <i class="none"></i>
        Jawr dwr3.x repository</a>
            </li>
                
      <li>
  
                          <a href="https://github.com/j-a-w-r/jawr-tools" class="externalLink" title="Jawr tools repository">
          <i class="none"></i>
        Jawr tools repository</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>How to use Smart bundling feature in Jawr<a name="How_to_use_Smart_bundling_feature_in_Jawr"></a></h2>
<div class="section">
<h3>Smart bundling feature<a name="Smart_bundling_feature"></a></h3>
<p>Historically, Jawr regenerate all defined bundles at server startup. Depending on the bundle definition, the start-up time could be long. To fix this issue, Jawr introduces since Jawr 3.9 a new feature called &#x201c;smart bundling&#x201d; which allow Jawr analyze the bundle which have changed, and only rebuild these bundles. The smart bundling feature extends existing features to help to speed up the bundling process. This tutorial will explain you how to setup Jawr to use this feature.</p>
<p>The property <b>jawr.use.bundle.mapping</b> introduced in Jawr 3.0, when set to true, force Jawr to create files which contains the result of the bundle process.<br />Once generated, Jawr was not rebuilding the bundles. This was a good improvement to speed up start up time, but unfortunately when the bundles were modified the bundles were not rebuild.&#xa0;</p>
<p>Now Jawr is able to determine if the bundles have changed since the last bundle processing, in every case (server started or stopped).</p>
<p>The property <b>jawr.config.reload.interval</b> was previously used to determine the interval between Jawr configuration file reload to check if there were changes in Jawr configuration. Now Jawr checks also if the content of the files associated to the bundles have changed. This means that if a file content changed Jawr will rebuild the bundles.</p></div>
<div class="section">
<h3>Enabling &#x201c;Smart bundling&#x201d;<a name="Enabling_Smart_bundling"></a></h3>
<p>By default, the smart bundling feature is deactivated. The property <b>jawr.use.smart.bundling</b> can be used to unable or disable it.</p>

<div class="source">
<pre>        jawr.use.smart.bundling=true #This will enable the smart bundling feature
</pre></div>
<p>Note : It is important to note that if you enable the smart bundling feature, the use bundle mapping property will be enable by default, because it&#x2019;s a prerequisite to use the smart bundling feature</p></div>
<div class="section">
<h3>Smart bundling with automatic bundle processing when application is started<a name="Smart_bundling_with_automatic_bundle_processing_when_application_is_started"></a></h3>
<p>If you want to use the automatic bundle processing when your application is started, you have update your Jawr configuration file like below :</p>

<div class="source">
<pre>        jawr.config.reload.interval=10 #Here we configured Jawr to check for update every 10 sec
</pre></div>
<p>Using this configuration, if a change is detected on a bundle when the server is started, the bundle will be rebuild.</p></div>
<div class="section">
<h3>Smart bundling with automatic bundle processing when application is started and force bundling using JMX<a name="Smart_bundling_with_automatic_bundle_processing_when_application_is_started_and_force_bundling_using_JMX"></a></h3>
<p>If you want to use the automatic bundle processing when your application is started, and also being able to force the refresh using JMX, you have update your Jawr configuration file like below :</p>

<div class="source">
<pre>        jawr.use.smart.bundling=true #This will enable the smart bundling feature
</pre></div>
<p>To force bundle processing using JMX, you need to execute the method <b>refreshConfig()</b>. You&#x2019;ll be able to refresh the configuration for one resource type, or for all resources by selecting the right <b>JawrConfigManagerMBean</b> or the <b>JawrApplicationConfigManagerMBean</b>. Please refer to the <a href="../docs/jmx_support.html">JMX documentation</a> for more detail.</p>
<p>Note : The recommended way to force rebuild is to use JMX. It&#x2019;s a more secure way to handle this use case. In some cases, JMX could not be an option, in these cases, you can use the refreshKey URL parameter. (see below)</p></div>
<div class="section">
<h3>Smart bundling with automatic bundle processing when application is started and a key to force bundle processing<a name="Smart_bundling_with_automatic_bundle_processing_when_application_is_started_and_a_key_to_force_bundle_processing"></a></h3>
<p>If you want to use the automatic bundle processing when your application is started, and also being able to force the refresh using a key, you have update your Jawr configuration file like below :</p>

<div class="source">
<pre>        jawr.use.smart.bundling=true #This will enable the smart bundling feature
        jawr.config.reload.interval=3600 #Here we configured Jawr to check for update every hour
        jawr.config.reload.refreshKey=mySecretKey #To force a refresh of bundles which needs to be rebuild, hit any bundle URL and add ?refreshKey=mySecretKey to reload the bundles.
</pre></div>
<p>Using this configuration, if a change on a bundle is detected when Jawr checks the configuration or if the refresh is forced using the refresh key parameter, the bundle will be rebuild. The information are stored in the bundle mapping files.</p></div>
<div class="section">
<h3>Smart bundling only on server restart<a name="Smart_bundling_only_on_server_restart"></a></h3>
<p>If you want to use the smart bundling feature only on server restart, you only have to set the <b>jawr.use.bundle.mapping</b> property to <b>true</b>, in your Jawr configuration file like below :</p>

<div class="source">
<pre>        jawr.use.smart.bundling=true #This will enable the smart bundling feature
</pre></div>
<p>Using this configuration, if a change is detected on a bundle when the server is started, the bundle will not be rebuild until next server restart.</p></div>
<div class="section">
<h3>Delay since last resource event<a name="Delay_since_last_resource_event"></a></h3>
<p>Jawr watches resources on server to detect resource creation, modification or deletion using WatchService API. When there are a lot of events, to ensure that all events have been processed before starting the bundling process, Jawr uses a delay after the last event to make sure that there no more event to process before starting the bundling process.</p>
<p>This delay is configurable using the property <b>jawr.smart.bundling.delay.after.last.event</b> :</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th><b>Property name</b> </th>
      
<th><b>Type</b> </th>
      
<th><b>Purpose</b> </th>
      
<th><b>Default value</b> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>jawr.smart.bundling.delay.after.last.event </td>
      
<td>Integer </td>
      
<td>Defines the delay after the last event before starting the bundle processing (in second) </td>
      
<td>2 </td>
    </tr>
  </tbody>
</table></div>
<div class="section">
<h3>Global processing<a name="Global_processing"></a></h3>
<p>Jawr allows the user to defines processor which can process all the bundles at once. An example of these kind of processors is the smartsprite global preprocessor, which will retrieve information about CSS sprite defines in every bundle and which will update sprite reference in all the bundles.</p></div>
<div class="section">
<h3>Smartsprite global preprocessing<a name="Smartsprite_global_preprocessing"></a></h3>
<p>By nature, it is not possible to avoid the processing of all bundle for these global processors, but Jawr will try to find the impacted bundles after the global preprocessing phase, to only process those bundles.</p>
<p>To make sure that change are detected, you need to put <b>${md5}</b> property in the image of the sprite-ref, like below :</p>

<div class="source">
<pre>/** sprite: mysprite; sprite-image: url('../../img/mysprite-${md5}.png'); sprite-layout: vertical */ 

.header {
        background-image: url(&quot;../../../img/logo.png&quot;); /** sprite-ref: mysprite; */
        background-repeat: no-repeat;
        height : 74px;
}
</pre></div></div>
<div class="section">
<h3>Force complete rebuild<a name="Force_complete_rebuild"></a></h3>
<p>There are two way to force the complete rebuild (ignoring the information in cache) :</p>

<ul>
  
<li>
<p>Clean the web application working directory where the files for cache are stored</p></li>
  
<li>
<p>Modify your Jawr configuration file</p></li>
</ul></div>
<div class="section">
<h3>Known limitations<a name="Known_limitations"></a></h3>
<p>For the time being, this feature only works with modification on the file resources associated to bundle like :  - modifying a resource  - creating or deleting a resource on a bundle which has a mapping defines with wildcards  For example, if you have a bundle mapping like &#x2018;/css/**&#x2019;, adding a resource to &#x2018;/css&#x2019; or deleting one will be handle as a bundle modification</p>
<p>If you modify your configuration, Jawr will consider this as a complete modification and will rebuild all the bundles. So a modification in your configuration will trigger a full bundling process.</p>
<p>Jawr doesn&#x2019;t detect modification on Processor or Generator class. So if a Processor or a Generator has been modified, you&#x2019;ll have to clean your cache so Jawr will rebuild the bundles with this modification.</p></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                   2017.
          All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
